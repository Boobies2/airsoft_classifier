# README для Jupyter Notebooks

## Обзор

Этот репозиторий содержит две Jupyter-тетрадки для разных задач машинного обучения:

1. **`subcategory_model.ipynb`**: Модель компьютерного зрения для классификации подкатегорий оружия с использованием архитектуры ResNet18.
2. **`category_model.ipynb`**: NLP-модель для классификации текстовых постов по категориям с использованием BERT.

---

## `subcategory_model.ipynb`

### Описание
Эта тетрадка обучает модель глубокого обучения для классификации изображений оружия и связанных предметов на 11 подкатегорий (например, "ak", "pistol", "helmet" и т.д.). Модель основана на предобученной архитектуре ResNet18, дообученной на пользовательском датасете.

### Ключевые особенности
- **Датасет**: Изображения загружаются из структуры директорий, где каждая подпапка представляет класс.
- **Аугментация данных**: Случайное изменение размера, отражение по горизонтали и поворот для улучшения обобщения модели.
- **Модель**: ResNet18 с заменой последнего слоя для 11 классов.
- **Обучение**: 15 эпох с использованием Adam оптимизатора и StepLR планировщика.
- **Результаты**: Лучшая точность на валидации - 94.7%.

### Использование
1. Убедитесь, что у вас есть папка с данными в структуре: `DATA_DIR/класс/изображения.jpg`.
2. Запустите все ячейки для обучения модели.
3. Обученная модель сохраняется в `weapon_classifier.pth`.

---

## `category_model.ipynb`

### Описание
Эта тетрадка обучает BERT-модель для классификации текстовых постов на 3 категории:
- "Аксессуары и Запчасти"
- "Снаряжение и защита"
- "Страйкбольное оружие"

### Ключевые особенности
- **Датасет**: Текстовые данные в формате parquet, предварительно очищенные от пропусков.
- **Токенизация**: Используется BERT-токенизатор с максимальной длиной 128 токенов.
- **Модель**: `BertForSequenceClassification` на основе `bert-base-uncased`.
- **Обучение**: 3 эпохи с batch size 16, warmup steps 500.
- **Результаты**: F1-score 0.88 на валидационном наборе.

### Использование
1. Подготовьте данные в формате parquet с колонками 'Text' и 'categoryname'.
2. Запустите все ячейки для обучения модели.
3. Модель и токенизатор сохраняются в папку `category_bert_model`, а LabelEncoder - в `category_label_encoder.pkl`.

---

## Требования
- Python 3.7+
- Библиотеки: torch, torchvision, transformers, sklearn, pandas
- GPU рекомендуется для ускорения обучения

## Установка
```bash
pip install torch torchvision transformers scikit-learn pandas
```